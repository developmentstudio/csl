detector "Detector Name" {

    A = request {
        timestamp = "2014-10-16T03:33:49+02:00"
        method = "GET"
        remoteAddress = """83.[0-9]{1,3}.[0-9]{1,3}.(67|68)"""
        cookies {}
        url {
            query {
                cct = """a73aeae2cace927a516f8377cf55691[a-z]{1}"""
            }
        }
    } => response {
        status = 200
    }

    find {
        pattern {
            A -> C -> B -> C
        } with relation on {
            request.remoteAddress
        }

        /*
        constraints {
            duration > 100 units and < 50 units
            remoteAddress > 1 different
            exact = false
        }
        */
    }

    C = request {
        timestamp = "2014-10-16T03:33:49+02:00"
        method = "GET"
        remoteAddress = """83.[0-9]{1,3}.[0-9]{1,3}.(67|68)"""
        cookies {}
        url {
            query {
                cct = """a73aeae2cace927a516f8377cf55691[a-z]{1}"""
            }
        }
    } => response {
        status = 200
    }

    B = request {
        timestamp = "2014-10-16T03:33:49+02:00"
        method = "GET"
        remoteAddress = """83.[0-9]{1,3}.[0-9]{1,3}.(67|68)"""
        cookies {}
        url {
            query {
                cct = """a73aeae2cace927a516f8377cf55691[a-z]{1}"""
            }
        }
    } => response {
        status = 200
    }

}
